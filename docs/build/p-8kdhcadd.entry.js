import{r as e,f as t,c as i,h as a,H as n,e as s}from"./p-212d0ebd.js";import{c as o,f as r,b as l}from"./p-c1fca2fc.js";import{h}from"./p-20d65ce5.js";import{b as d}from"./p-d50d6489.js";const u=(e,t)=>{const i=k(e,t);if(void 0!==i)return i;const a=b((new Date).toISOString());return k(a,t)},m=(e,t,i)=>{if(void 0===t)return;const a=[];let n=!1;if(K.forEach((s,o)=>{if(e.indexOf(s.f)>-1){const r="{"+o+"}",l=c(s.f,t[s.k],t,i);n||void 0===l||null==t[s.k]||(n=!0),a.push(r,l||""),e=e.replace(s.f,r)}}),n){for(let t=0;t<a.length;t+=2)e=e.replace(a[t],a[t+1]);return e}},c=(e,t,i,a)=>{if(e!==j&&e!==z){if(e===q)return void 0!==i&&void 0!==i.hour?i.hour<12?"AM":"PM":t?t.toUpperCase():"";if(e===G)return void 0!==i&&void 0!==i.hour?i.hour<12?"am":"pm":t||"";if(null==t)return"";if(e===Y||e===A||e===P||e===H||e===_||e===U)return F(t);if(e===I)return V(t);if(e===T)return(a.monthNames?a.monthNames:te)[t-1];if(e===$)return(a.monthShortNames?a.monthShortNames:ie)[t-1];if(e===L||e===Z){if(0===t)return"12";if(t>12&&(t-=12),e===L&&t<10)return"0"+t}return t.toString()}try{return t=new Date(i.year,i.month-1,i.day).getDay(),e===j?(a.dayNames?a.dayNames:Q)[t]:(a.dayShortNames?a.dayShortNames:ee)[t]}catch(e){}},f=(e,t,i)=>{const a=[];if(e===I||e===Y){if(void 0===i.year||void 0===t.year)throw new Error("min and max year is undefined");for(let e=i.year;e>=t.year;e--)a.push(e)}else if(e===T||e===$||e===A||e===W||e===L||e===Z)for(let e=1;e<13;e++)a.push(e);else if(e===j||e===z||e===P||e===B)for(let e=1;e<32;e++)a.push(e);else if(e===H||e===J)for(let e=0;e<24;e++)a.push(e);else if(e===_||e===R)for(let e=0;e<60;e++)a.push(e);else if(e===U||e===X)for(let e=0;e<60;e++)a.push(e);else e!==q&&e!==G||a.push("am","pm");return a},p=(e,t,i,a=0,n=0)=>parseInt(`1${V(e)}${F(t)}${F(i)}${F(a)}${F(n)}`,10),y=e=>p(e.year,e.month,e.day,e.hour,e.minute),v=(e,t)=>4===e||6===e||9===e||11===e?30:2===e?g(t)?29:28:31,g=e=>e%4==0&&e%100!=0||e%400==0,x=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/,M=/^((\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/,b=e=>{let t=null;if(null!=e&&""!==e&&((t=M.exec(e))?(t.unshift(void 0,void 0),t[2]=t[3]=void 0):t=x.exec(e)),null===t)return;for(let e=1;e<8;e++)t[e]=void 0!==t[e]?parseInt(t[e],10):void 0;let i=0;return t[9]&&t[10]&&(i=60*parseInt(t[10],10),t[11]&&(i+=parseInt(t[11],10)),"-"===t[9]&&(i*=-1)),{year:t[1],month:t[2],day:t[3],hour:t[4],minute:t[5],second:t[6],millisecond:t[7],tzOffset:i}},D=(e,t)=>{if(!t||"string"==typeof t){const e=((e="")=>{null==e&&(e=""),10!==e.length&&7!==e.length||(e+=" ");const t="string"==typeof e&&e.length>0?new Date(e):new Date;return new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))})(t);Number.isNaN(e.getTime())||(t=e.toISOString())}if(t&&""!==t){if("string"==typeof t){if(t=b(t))return Object.assign(e,t),!0}else if(t.year||t.hour||t.month||t.day||t.minute||t.second){t.ampm&&t.hour&&(t.hour.value="pm"===t.ampm.value?12===t.hour.value?12:t.hour.value+12:12===t.hour.value?0:t.hour.value);for(const i of Object.keys(t))e[i]=t[i].value;return!0}console.warn(`Error parsing date: "${t}". Please provide a valid ISO 8601 datetime format: https://www.w3.org/TR/NOTE-datetime`)}else for(const t in e)e.hasOwnProperty(t)&&delete e[t];return!1},S=e=>{const t=[];e=e.replace(/[^\w\s]/gi," "),K.forEach(t=>{t.f.length>1&&e.indexOf(t.f)>-1&&e.indexOf(t.f+t.f.charAt(0))<0&&(e=e.replace(t.f," "+t.f+" "))});const i=e.split(" ").filter(e=>e.length>0);return i.forEach((e,a)=>{K.forEach(n=>{if(e===n.f){if((e===q||e===G)&&(t.indexOf(Z)<0&&t.indexOf(L)<0||-1===ae.indexOf(i[a-1])))return;t.push(e)}})}),t},k=(e,t)=>t===q||t===G?e.hour<12?"am":"pm":t===L||t===Z?e.hour>12?e.hour-12:e.hour:e[w(t)],w=e=>{for(const t in K)if(K[t].f===e)return K[t].k},C=e=>{let t="";return void 0!==e.year?(t=V(e.year),void 0!==e.month&&(t+="-"+F(e.month),void 0!==e.day&&(t+="-"+F(e.day),void 0!==e.hour&&(t+=`T${F(e.hour)}:${F(e.minute)}:${F(e.second)}`,e.millisecond>0&&(t+="."+E(e.millisecond)),t+=void 0===e.tzOffset?"Z":(e.tzOffset>0?"+":"-")+F(Math.floor(Math.abs(e.tzOffset/60)))+":"+F(e.tzOffset%60))))):void 0!==e.hour&&(t=F(e.hour)+":"+F(e.minute),void 0!==e.second&&(t+=":"+F(e.second),void 0!==e.millisecond&&(t+="."+E(e.millisecond)))),t},O=(e,t)=>{if(null==e)return;let i;return"string"==typeof e&&(e=e.replace(/\[|\]/g,"").split(",")),Array.isArray(e)&&(i=e.map(e=>e.toString().trim())),void 0!==i&&0!==i.length||console.warn(`Invalid "${t}Names". Must be an array of strings, or a comma separated string.`),i},N=(e,t)=>{let i;return"string"==typeof e&&(e=e.replace(/\[|\]|\s/g,"").split(",")),0===(i=Array.isArray(e)?e.map(e=>parseInt(e,10)).filter(isFinite):[e]).length&&console.warn(`Invalid "${t}Values". Must be an array of numbers, or a comma separated string of numbers.`),i},F=e=>("0"+(void 0!==e?Math.abs(e):"0")).slice(-2),E=e=>("00"+(void 0!==e?Math.abs(e):"0")).slice(-3),V=e=>("000"+(void 0!==e?Math.abs(e):"0")).slice(-4),I="YYYY",Y="YY",T="MMMM",$="MMM",A="MM",W="M",j="DDDD",z="DDD",P="DD",B="D",H="HH",J="H",L="hh",Z="h",_="mm",R="m",U="ss",X="s",q="A",G="a",K=[{f:I,k:"year"},{f:T,k:"month"},{f:j,k:"day"},{f:$,k:"month"},{f:z,k:"day"},{f:Y,k:"year"},{f:A,k:"month"},{f:P,k:"day"},{f:H,k:"hour"},{f:L,k:"hour"},{f:_,k:"minute"},{f:U,k:"second"},{f:W,k:"month"},{f:B,k:"day"},{f:J,k:"hour"},{f:Z,k:"hour"},{f:R,k:"minute"},{f:X,k:"second"},{f:q,k:"ampm"},{f:G,k:"ampm"}],Q=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ee=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],te=["January","February","March","April","May","June","July","August","September","October","November","December"],ie=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ae=[L,Z,_,R,U,X];class ne{constructor(i){e(this,i),this.inputId=`ion-dt-${re++}`,this.locale={},this.datetimeMin={},this.datetimeMax={},this.datetimeValue={},this.isExpanded=!1,this.name=this.inputId,this.disabled=!1,this.readonly=!1,this.displayFormat="MMM D, YYYY",this.cancelText="Cancel",this.doneText="Done",this.onClick=()=>{this.setFocus(),this.open()},this.onFocus=()=>{this.ionFocus.emit()},this.onBlur=()=>{this.ionBlur.emit()},this.ionCancel=t(this,"ionCancel",7),this.ionChange=t(this,"ionChange",7),this.ionFocus=t(this,"ionFocus",7),this.ionBlur=t(this,"ionBlur",7),this.ionStyle=t(this,"ionStyle",7)}disabledChanged(){this.emitStyle()}valueChanged(){this.updateDatetimeValue(this.value),this.emitStyle(),this.ionChange.emit({value:this.value})}componentWillLoad(){this.locale={monthNames:O(this.monthNames,"monthNames"),monthShortNames:O(this.monthShortNames,"monthShortNames"),dayNames:O(this.dayNames,"dayNames"),dayShortNames:O(this.dayShortNames,"dayShortNames")},this.updateDatetimeValue(this.value),this.emitStyle()}async open(){if(this.disabled||this.isExpanded)return;const e=this.generatePickerOptions(),t=await d.create(e);this.isExpanded=!0,t.onDidDismiss().then(()=>{this.isExpanded=!1,this.setFocus()}),t.addEventListener("ionPickerColChange",async e=>{const i=e.detail,a={};a[i.name]={value:i.options[i.selectedIndex].value},this.updateDatetimeValue(a);const n=this.generateColumns();t.columns=n,await this.validate(t)}),await this.validate(t),await t.present()}emitStyle(){this.ionStyle.emit({interactive:!0,datetime:!0,"has-placeholder":null!=this.placeholder,"has-value":this.hasValue(),"interactive-disabled":this.disabled})}updateDatetimeValue(e){D(this.datetimeValue,e)}generatePickerOptions(){const e=i(this),t=Object.assign({mode:e},this.pickerOptions,{columns:this.generateColumns()}),a=t.buttons;return a&&0!==a.length||(t.buttons=[{text:this.cancelText,role:"cancel",handler:()=>{this.updateDatetimeValue(this.value),this.ionCancel.emit()}},{text:this.doneText,handler:e=>{this.updateDatetimeValue(e);const t=new Date(C(this.datetimeValue));this.datetimeValue.tzOffset=-1*t.getTimezoneOffset(),this.value=C(this.datetimeValue)}}]),t}generateColumns(){let e=this.pickerFormat||this.displayFormat||oe;if(0===e.length)return[];this.calcMinMax(),-1===(e=e.replace("DDDD","{~}").replace("DDD","{~}")).indexOf("D")&&(e=e.replace("{~}","D")),e=e.replace(/{~}/g,"");const t=S(e).map(e=>{const t=w(e);let i;const a=(i=this[t+"Values"]?N(this[t+"Values"],t):f(e,this.datetimeMin,this.datetimeMax)).map(t=>({value:t,text:c(e,t,void 0,this.locale)})),n=u(this.datetimeValue,e),s=a.findIndex(e=>e.value===n);return{name:t,selectedIndex:s>=0?s:0,options:a}}),i=this.datetimeMin,a=this.datetimeMax;return["month","day","hour","minute"].filter(e=>!t.find(t=>t.name===e)).forEach(e=>{i[e]=0,a[e]=0}),se(t)}async validate(e){const t=new Date,i=y(this.datetimeMin),a=y(this.datetimeMax),n=await e.getColumn("year");let s=t.getFullYear();if(n){n.options.find(e=>e.value===t.getFullYear())||(s=n.options[0].value);const e=n.selectedIndex;if(void 0!==e){const t=n.options[e];t&&(s=t.value)}}const o=await this.validateColumn(e,"month",1,i,a,[s,0,0,0,0],[s,12,31,23,59]),r=v(o,s),l=await this.validateColumn(e,"day",2,i,a,[s,o,0,0,0],[s,o,r,23,59]),h=await this.validateColumn(e,"hour",3,i,a,[s,o,l,0,0],[s,o,l,23,59]);await this.validateColumn(e,"minute",4,i,a,[s,o,l,h,0],[s,o,l,h,59])}calcMinMax(){const e=(new Date).getFullYear();if(void 0!==this.yearValues){const e=N(this.yearValues,"year");void 0===this.min&&(this.min=Math.min(...e).toString()),void 0===this.max&&(this.max=Math.max(...e).toString())}else void 0===this.min&&(this.min=(e-100).toString()),void 0===this.max&&(this.max=e.toString());const t=this.datetimeMin=b(this.min),i=this.datetimeMax=b(this.max);t.year=t.year||e,i.year=i.year||e,t.month=t.month||1,i.month=i.month||12,t.day=t.day||1,i.day=i.day||31,t.hour=t.hour||0,i.hour=i.hour||23,t.minute=t.minute||0,i.minute=i.minute||59,t.second=t.second||0,i.second=i.second||59,t.year>i.year&&(console.error("min.year > max.year"),t.year=i.year-100),t.year===i.year&&(t.month>i.month?(console.error("min.month > max.month"),t.month=1):t.month===i.month&&t.day>i.day&&(console.error("min.day > max.day"),t.day=1))}async validateColumn(e,t,i,a,n,s,r){const l=await e.getColumn(t);if(!l)return 0;const h=s.slice(),d=r.slice(),u=l.options;let m=u.length-1,c=0;for(let e=0;e<u.length;e++){const t=u[e],o=t.value;h[i]=t.value,d[i]=t.value,(t.disabled=o<s[i]||o>r[i]||p(d[0],d[1],d[2],d[3],d[4])<a||p(h[0],h[1],h[2],h[3],h[4])>n)||(m=Math.min(m,e),c=Math.max(c,e))}const f=l.selectedIndex=o(m,l.selectedIndex,c),y=l.options[f];return y?y.value:0}get text(){if(null!=this.value&&0!==this.value.length)return m(this.displayFormat||this.pickerFormat||oe,this.datetimeValue,this.locale)}hasValue(){return void 0!==this.text}setFocus(){this.buttonEl&&this.buttonEl.focus()}render(){const{inputId:e,text:t,disabled:s,readonly:o,isExpanded:d,el:u,placeholder:m}=this,c=i(this),f=e+"-lbl",p=r(u),y=void 0===t&&null!=m,v=void 0===t?null!=m?m:"":t;return p&&(p.id=f),l(!0,u,this.name,this.value,this.disabled),a(n,{onClick:this.onClick,role:"combobox","aria-disabled":s?"true":null,"aria-expanded":`${d}`,"aria-haspopup":"true","aria-labelledby":f,class:{[c]:!0,"datetime-disabled":s,"datetime-readonly":o,"datetime-placeholder":y,"in-item":h("ion-item",u)}},a("div",{class:"datetime-text"},v),a("button",{type:"button",onFocus:this.onFocus,onBlur:this.onBlur,disabled:this.disabled,ref:e=>this.buttonEl=e}))}get el(){return s(this)}static get watchers(){return{disabled:["disabledChanged"],value:["valueChanged"]}}static get style(){return":host{padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);display:-ms-flexbox;display:flex;position:relative;min-width:16px;min-height:1.2em;font-family:var(--ion-font-family,inherit);text-overflow:ellipsis;white-space:nowrap;overflow:hidden;z-index:2}\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}:host(.in-item){position:static}:host(.datetime-placeholder){color:var(--placeholder-color)}:host(.datetime-disabled){opacity:.3;pointer-events:none}:host(.datetime-readonly){pointer-events:none}button{left:0;top:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;position:absolute;width:100%;height:100%;border:0;background:transparent;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none}:host-context([dir=rtl]) button,[dir=rtl] button{left:unset;right:unset;right:0}button::-moz-focus-inner{border:0}.datetime-text{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;-ms-flex:1;flex:1;min-height:inherit;direction:ltr;overflow:inherit}:host-context([dir=rtl]) .datetime-text,[dir=rtl] .datetime-text{direction:rtl}:host{--placeholder-color:var(--ion-placeholder-color,var(--ion-color-step-400,#999));--padding-top:10px;--padding-end:0;--padding-bottom:11px;--padding-start:16px}"}}const se=e=>{const t=[];let i,a;for(let n=0;n<e.length;n++){i=e[n],t.push(0);for(const e of i.options)(a=e.text.length)>t[n]&&(t[n]=a)}return 2===t.length?(a=Math.max(t[0],t[1]),e[0].align="right",e[1].align="left",e[0].optionsWidth=e[1].optionsWidth=`${17*a}px`):3===t.length&&(a=Math.max(t[0],t[2]),e[0].align="right",e[1].columnWidth=`${17*t[1]}px`,e[0].optionsWidth=e[2].optionsWidth=`${17*a}px`,e[2].align="left"),e},oe="MMM D, YYYY";let re=0;export{ne as ion_datetime};